<div class="wrapper" (click)="$event.stopPropagation();dropdown.closeAll()">

    <!-- Navbar -->

    <div class="navbar">
        <div class="left">
            <img src="/assets/logo.webp" draggable="false" width="36" height="36" alt="" style="position: absolute;left: 4px;user-select: none;" />
            <div class="title">
                <div class="application">
                    SCHOOLINGO
                </div>
                <div class="school">{{ school.schoolInfo.name }}</div>
            </div>
            <div class="options">
                <div class="item-btn show-sidebar" (click)="$event.stopPropagation();schoolingo.sidebar.sidebarToggled = !schoolingo.sidebar.sidebarToggled">
                    <div class="icon">
                        <i class="ti ti-menu-2"></i>
                    </div>
                    <div class="name">{{ schoolingo.locale.getLocale('sidebar/main') }}</div>
                </div>
            </div>
        </div>

        <div class="right">
            <div class="options">

                @if (schoolingo.userService.getUser()?.type == 'parent') {
                    <div class="item-btn" (click)="schoolingo.modal = 'switchChildren'">
                        <div class="icon">
                            <i class="ti ti-users"></i>
                        </div>
                        <div class="name">{{ schoolingo.locale.getLocale('dropdowns/switchChildren/title') }}</div>
                    </div>
                }

                <div class="item-btn" [routerLink]="['', 'user', 'settings']" [routerLinkActive]="'active'">
                    <div class="icon">
                        <i class="ti ti-settings"></i>
                    </div>
                    <div class="name">{{ schoolingo.locale.getLocale('settings') }}</div>
                </div>
            </div>
            <div class="user">
                @if (schoolingo.userService.getUser()) {
                    <p class="name">{{ schoolingo.userService.getUser()?.person?.firstName + ' ' + schoolingo.userService.getUser()?.person?.lastName }}</p>
                    <p class="role">{{ schoolingo.getUserRole() }}</p>
                }
            </div>
            <div class="btn logout" (click)="schoolingo.userService.logout()">
                {{ schoolingo.locale.getLocale('logout') }}
            </div>
        </div>
    </div>

    <div class="content">
        <div [ngClass]="{sidebar: true, active: schoolingo.sidebar.sidebarToggled}">
            @for (section of schoolingo.sidebar.data; track $index) {
                <ul>
                    @for (item of section.items; track $index) {
                        <li [routerLink]="item.url" (click)="item.url ? schoolingo.sidebar.sidebarToggled = false : {}"  [routerLinkActive]="'active'" [ngClass]="{ opened: item.children && item.children.length > 0 && schoolingo.sidebar.toggledDropdowns.includes($index) }" (click)="schoolingo.sidebar.toggleDropdown($index)">
                            <div class="item">
                                <div class="item-label">
                                    {{ schoolingo.locale.getLocale(item.item) }}
                                </div>
                                @if (item.children && item.children.length > 0) {
                                    <div class="dropdown-icon" [ngStyle]="{ transform: schoolingo.sidebar.toggledDropdowns.includes($index) ? 'rotate(180deg)' : '' }">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512">
                                            <path fill="currentColor" d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"/>
                                        </svg>
                                    </div>
                                }
                            </div>
                            @if (item.children && item.children.length > 0) {
                                <div class="dropdown-child" [ngStyle]="{height: schoolingo.sidebar.toggledDropdowns.includes($index) ? 'auto' : '0px'}" (click)="$event.stopPropagation()">
                                    <ul>
                                        @for (child of item.children; track $index) {
                                            <li (click)="schoolingo.sidebar.sidebarToggled = false" [routerLink]="child.url" [routerLinkActive]="'active'">
                                                <div class="item">
                                                    {{ schoolingo.locale.getLocale(child.item) }}
                                                </div>
                                            </li>
                                        }
                                    </ul>
                                </div>
                            }
                        </li>
                    }
                </ul>
            }
        </div>
        <div class="main-content" (click)="schoolingo.sidebar.sidebarToggled = false;">
            @if (alertManager.getAlerts("body").length > 0) {
                <div class="alerts">
                    @for (alert of alertManager.getAlerts("body"); track $index;) {}
                    <div class="alert error">
                        <div class="text">
                            {{ "" }}
                        </div>
                        <!-- <div class="actions">
                            <div class="btn">Stav služeb</div>
                        </div> -->
                        <div class="close">
                            <i class="ti ti-x"></i>
                        </div>
                    </div>
                </div>
            }
            <router-outlet></router-outlet>
        </div>
    </div>
</div>

@if(schoolingo.modal !== '') {
    <div class="modals" (click)="schoolingo.modal = ''">
        @switch (schoolingo.modal) {
            @case ("switchChildren") {
                @if (schoolingo.userService.getUser()?.type == "parent") {
                    <div class="modal" style="width: 500px;" (click)="$event.stopPropagation()">
                        <div class="modal-close" (click)="schoolingo.modal = ''">
                            <i class="ti ti-x"></i>
                        </div>
                        <div class="modal-header">
                            <i class="ti ti-users"></i>
                            {{ schoolingo.locale.getLocale('dropdowns/switchChildren/title') }}
                        </div>
                        <div class="alert error">
                            <div class="text">
                                Nepodařilo se spojit s našim systémem Schoolingo
                            </div>
                        </div>
                        <div class="modal-center">
                            <div class="modal-body scroll">
                                @for (child of schoolingo.userService.children; track $index) {
                                    <div [ngClass]="{child: true, active: schoolingo.userService.selectedChild == $index}">
                                        <div class="left">
                                            <div class="child-name">{{ child.firstName + ' ' + child.lastName  }}</div>
                                            <div class="child-info">{{ child.class }}</div>
                                        </div>
                                        <div class="right">
                                            @if (schoolingo.userService.selectedChild !== $index) {
                                                <div class="btn" (click)="schoolingo.userService.selectedChild = $index">Přepnout</div>
                                            }
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                }
            }
        }
    </div>
}
s
<schoolingo-dropdowns></schoolingo-dropdowns>